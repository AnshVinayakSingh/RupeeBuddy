<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RupeeBuddy Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    body {
      background-color: #f4f4f4;
      color: #333;
      line-height: 1.6;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .dark-mode {
      background-color: #1a1a1a;
      color: #e0e0e0;
    }
    .header {
      background-color: #fff;
      padding: 10px 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
    }
    .dark-mode .header {
      background-color: #2c2c2c;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    .logo-container {
      display: flex;
      align-items: center;
    }
    .logo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }
    .logo img, .logo svg {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .edit-icon {
      position: absolute;
      bottom: 0;
      right: 0;
      background-color: #1e90ff;
      color: #fff;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      cursor: pointer;
    }
    .dark-mode .edit-icon {
      background-color: #104e8b;
    }
    .edit-icon:hover {
      background-color: #104e8b;
    }
    .theme-toggle {
      font-size: 1.5rem;
      cursor: pointer;
      margin-right: 20px;
    }
    .dark-mode .theme-toggle::before {
      content: '‚òÄÔ∏è';
    }
    .theme-toggle::before {
      content: 'üåô';
    }
    .nav-toggle {
      display: none;
      font-size: 1.5rem;
      cursor: pointer;
    }
    .sidebar {
      width: 250px;
      background-color: #fff;
      height: calc(100vh - 60px);
      position: fixed;
      top: 60px;
      left: 0;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
    .dark-mode .sidebar {
      background-color: #2c2c2c;
    }
    .sidebar ul {
      list-style: none;
      padding: 20px 0;
    }
    .sidebar ul li {
      padding: 15px 20px;
    }
    .sidebar ul li a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }
    .dark-mode .sidebar ul li a {
      color: #e0e0e0;
    }
    .sidebar ul li a:hover {
      color: #1e90ff;
    }
    .main-content {
      margin-left: 250px;
      padding: 20px;
      transition: margin-left 0.3s ease;
    }
    .card {
      background-color: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .dark-mode .card {
      background-color: #2c2c2c;
    }
    .card h2 {
      color: #1e90ff;
      margin-bottom: 10px;
      font-size: 1.5rem;
    }
    .editable-field {
      display: flex;
      align-items: center;
      position: relative;
    }
    .editable-field input {
      flex: 1;
      padding: 8px 12px;
      font-size: 1.2rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #fff;
      color: #333;
      transition: border-color 0.3s ease;
    }
    .dark-mode .editable-field input {
      background-color: #2c2c2c;
      border-color: #444;
      color: #e0e0e0;
    }
    .editable-field input:focus {
      border-color: #1e90ff;
      outline: none;
    }
    .verify-button {
      padding: 10px 20px;
      background-color: #28a745;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease;
    }
    .dark-mode .verify-button {
      background-color: #218838;
    }
    .verify-button:hover {
      background-color: #218838;
      transform: scale(1.05);
    }
    .profile-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      width: 400px;
      max-width: 90%;
      color: #fff;
      text-align: center;
    }
    .dark-mode .profile-popup {
      background-color: #1a1a1a;
    }
    .profile-popup.active {
      display: block;
    }
    .profile-popup .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
    }
    .dark-mode .profile-popup .close-btn {
      color: #e0e0e0;
    }
    .profile-popup .close-btn:hover {
      color: #ff0000;
    }
    .profile-options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .profile-option {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.3s ease, transform 0.3s ease;
    }
    .profile-option:hover {
      border-color: #1e90ff;
      transform: scale(1.1);
    }
    .profile-option img, .profile-option svg {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      width: 500px;
      color: #fff;
      font-size: 1.2rem;
    }
    .dark-mode .popup {
      background-color: #1a1a1a;
    }
    .popup.active {
      display: block;
    }
    .popup .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
    }
    .dark-mode .popup .close-btn {
      color: #e0e0e0;
    }
    .popup .close-btn:hover {
      color: #ff0000;
    }
    .popup .input-group {
      margin-bottom: 25px;
    }
    .popup .input-container {
      display: flex;
      align-items: center;
    }
    .popup input {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #333;
      color: #fff;
      font-size: 1.2rem;
    }
    .dark-mode .popup input {
      background-color: #444;
      border-color: #555;
      color: #e0e0e0;
    }
    .popup .otp-field {
      display: none;
      margin-top: 10px;
    }
    .add-money-options {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      width: 400px;
      color: #fff;
      text-align: center;
    }
    .dark-mode .add-money-options {
      background-color: #1a1a1a;
    }
    .add-money-options.active {
      display: block;
    }
    .add-money-options .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
    }
    .dark-mode .add-money-options .close-btn {
      color: #e0e0e0;
    }
    .add-money-options .close-btn:hover {
      color: #ff0000;
    }
    .add-money-options button, .add-money-options input[type="button"] {
      display: block;
      width: 80%;
      padding: 12px;
      margin: 12px auto;
      background-color: #1e90ff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
    }
    .dark-mode .add-money-options button, .dark-mode .add-money-options input[type="button"] {
      background-color: #104e8b;
    }
    .add-money-options button:hover, .add-money-options input[type="button"]:hover {
      background-color: #104e8b;
    }
    .add-money-options input[type="text"] {
      width: 80%;
      padding: 12px;
      margin: 12px auto;
      background-color: #333;
      border: 1px solid #ccc;
      border-radius: 5px;
      color: #fff;
      font-size: 1rem;
    }
    .dark-mode .add-money-options input[type="text"] {
      background-color: #444;
      border-color: #555;
      color: #e0e0e0;
    }
    .card-option {
      margin: 10px 0;
    }
    .video-kyc-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      width: 600px;
      max-width: 90%;
      color: #fff;
      text-align: center;
      animation: fadeIn 0.3s ease-in-out;
    }
    .dark-mode .video-kyc-popup {
      background-color: #1a1a1a;
    }
    .video-kyc-popup.active {
      display: block;
    }
    .video-kyc-popup .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 1.8rem;
      cursor: pointer;
      color: #fff;
      transition: color 0.2s;
    }
    .dark-mode .video-kyc-popup .close-btn {
      color: #e0e0e0;
    }
    .video-kyc-popup .close-btn:hover {
      color: #ff0000;
    }
    .video-kyc-popup video {
      width: 100%;
      max-height: 400px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 2px solid #1e90ff;
    }
    .video-kyc-popup .timer {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 15px;
      color: #28a745;
      background-color: rgba(255, 255, 255, 0.1);
      padding: 10px;
      border-radius: 5px;
    }
    .video-kyc-popup button {
      padding: 12px 25px;
      background-color: #1e90ff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
      font-size: 1.1rem;
      transition: background-color 0.2s, transform 0.2s;
    }
    .dark-mode .video-kyc-popup button {
      background-color: #104e8b;
    }
    .video-kyc-popup button:hover {
      background-color: #104e8b;
      transform: scale(1.05);
    }
    .verified-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #000;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      width: 400px;
      color: #fff;
      text-align: center;
    }
    .dark-mode .verified-popup {
      background-color: #1a1a1a;
    }
    .verified-popup.active {
      display: block;
    }
    .verified-popup .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
    }
    .dark-mode .verified-popup .close-btn {
      color: #e0e0e0;
    }
    .verified-popup .close-btn:hover {
      color: #ff0000;
    }
    .tick-animation {
      width: 100px;
      height: 100px;
      margin: 20px auto;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .tick-animation svg {
      width: 60px;
      height: 60px;
    }
    .tick-animation .circle {
      fill: none;
      stroke: #28a745;
      stroke-width: 6;
      stroke-opacity: 0;
      transform-origin: center;
      animation: circleFade 0.5s ease-in-out forwards;
    }
    .tick-animation .checkmark {
      fill: none;
      stroke: #28a745;
      stroke-width: 6;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-dasharray: 48;
      stroke-dashoffset: 48;
      animation: drawCheck 0.6s ease-in-out 0.5s forwards;
    }
    .tick-animation {
      animation: scaleTick 0.3s ease-in-out 1.1s forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translate(-50%, -60%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }
    @keyframes circleFade {
      0% { stroke-opacity: 0; transform: scale(0); }
      100% { stroke-opacity: 0.2; transform: scale(1); }
    }
    @keyframes drawCheck {
      0% { stroke-dashoffset: 48; }
      100% { stroke-dashoffset: 0; }
    }
    @keyframes scaleTick {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    @media (max-width: 768px) {
      .nav-toggle {
        display: block;
      }
      .sidebar {
        transform: translateX(-250px);
      }
      .sidebar.active {
        transform: translateX(0);
      }
      .main-content {
        margin-left: 0;
      }
      .popup, .video-kyc-popup, .verified-popup, .profile-popup {
        width: 90%;
        padding: 20px;
        font-size: 1.1rem;
      }
      .popup input {
        font-size: 1.1rem;
      }
      .add-money-options {
        width: 90%;
        padding: 20px;
      }
      .add-money-options button, .add-money-options input[type="button"], .add-money-options input[type="text"] {
        font-size: 0.9rem;
      }
      .video-kyc-popup video {
        max-height: 300px;
      }
      .video-kyc-popup .timer {
        font-size: 1.5rem;
      }
      .tick-animation {
        width: 80px;
        height: 80px;
      }
      .tick-animation svg {
        width: 48px;
        height: 48px;
      }
      .profile-option {
        width: 60px;
        height: 60px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo-container">
      <div class="logo" id="logo">
        <svg viewBox="0 0 50 50">
          <circle cx="25" cy="25" r="25" fill="#1e90ff"/>
          <text x="25" y="32" font-size="20" fill="#fff" text-anchor="middle">RB</text>
        </svg>
        <span class="edit-icon" onclick="toggleProfilePopup()">‚úé</span>
      </div>
    </div>
    <div class="theme-toggle" onclick="toggleDarkMode()" aria-label="Toggle dark mode"></div>
    <div class="nav-toggle" onclick="toggleSidebar()">‚ò∞</div>
  </div>
  <div class="sidebar" id="sidebar">
    <ul>
      <li><a href="dashboard.html">Dashboard</a></li>
    </ul>
  </div>
  <div class="main-content">
    <div class="card">
      <h2>Name</h2>
      <div class="editable-field">
        <input type="text" id="userNameInput" placeholder="Enter your name">
      </div>
    </div>
    <div class="card">
      <h2>Mobile Number</h2>
      <div class="editable-field">
        <input type="text" id="mobileNumberInput" placeholder="Enter your mobile number">
      </div>
    </div>
    <div class="card">
      <h2>Email</h2>
      <div class="editable-field">
        <input type="email" id="emailAddressInput" placeholder="Enter your email">
      </div>
    </div>
    <div class="card">
      <h2>Get Verified</h2>
      <button class="verify-button" onclick="togglePopup()">Verify Now</button>
    </div>
    <div class="card">
      <h2>Add Money</h2>
      <p>Add funds to your account:</p>
      <button class="verify-button" style="padding: 8px 15px; margin-top: 10px;" onclick="toggleAddMoneyOptions()">Add</button>
    </div>
    <div class="card">
      <h2>Video KYC</h2>
      <p>Complete your Video KYC to verify your identity.</p>
      <button class="verify-button" style="padding: 8px 15px; margin-top: 10px;" onclick="startVideoKYC()">Verify</button>
    </div>
    <div class="card">
      <h2>Active Loans</h2>
      <p>1 Active Loan of 1000 Rupees</p>
    </div>
    <div class="card">
      <h2>Recent Transactions</h2>
      <p>Loan Funded: ‚Çπ500 (Apr 16, 2025)</p>
      <p>Return Received: ‚Çπ535 (Apr 15, 2025)</p>
    </div>
    <div class="card">
      <h2>Disclaimer</h2>
      <p>If you fail to repay the loan amount on time, the longer you delay, the higher the returns you will have to pay. Additionally, after the due date, the money may be automatically debited from your account.</p>
    </div>
  </div>
  <div class="profile-popup" id="profilePopup">
    <span class="close-btn" onclick="toggleProfilePopup()">√ó</span>
    <h3>Select Profile Picture</h3>
    <div class="profile-options">
      <div class="profile-option" onclick="selectProfile('default')">
        <svg viewBox="0 0 50 50">
          <circle cx="25" cy="25" r="25" fill="#1e90ff"/>
          <text x="25" y="32" font-size="20" fill="#fff" text-anchor="middle">RB</text>
        </svg>
      </div>
      <div class="profile-option" onclick="selectProfile('cat')">
        <svg viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="40" fill="#ffcc00"/>
          <circle cx="35" cy="40" r="8" fill="#000"/>
          <circle cx="65" cy="40" r="8" fill="#000"/>
          <path d="M 30 20 L 40 30 L 50 20" fill="none" stroke="#000" stroke-width="4"/>
          <path d="M 50 20 L 60 30 L 70 20" fill="none" stroke="#000" stroke-width="4"/>
          <path d="M 40 60 Q 50 70 60 60" fill="none" stroke="#000" stroke-width="4"/>
        </svg>
      </div>
      <div class="profile-option" onclick="selectProfile('ninja')">
        <svg viewBox="0 0 100 100">
          <circle cx="50" cy="50" r="40" fill="#333"/>
          <rect x="30" y="30" width="40" height="10" fill="#ff0000"/>
          <circle cx="40" cy="50" r="5" fill="#fff"/>
          <circle cx="60" cy="50" r="5" fill="#fff"/>
          <path d="M 30 70 L 50 90 L 70 70" fill="none" stroke="#fff" stroke-width="4"/>
        </svg>
      </div>
      <div class="profile-option" onclick="selectProfile('robot')">
        <svg viewBox="0 0 100 100">
          <rect x="30" y="30" width="40" height="40" fill="#4a4a4a" rx="5"/>
          <rect x="45" y="20" width="10" height="10" fill="#4a4a4a"/>
          <circle cx="40" cy="45" r="5" fill="#00ff00"/>
          <circle cx="60" cy="45" r="5" fill="#00ff00"/>
          <path d="M 35 55 Q 50 60 65 55" fill="none" stroke="#00ff00" stroke-width="3"/>
          <rect x="35" y="70" width="30" height="10" fill="#4a4a4a"/>
        </svg>
      </div>
      <div class="profile-option" onclick="selectProfile('star')">
        <svg viewBox="0 0 100 100">
          <defs>
            <linearGradient id="starGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#ff8c00;stop-opacity:1" />
            </linearGradient>
          </defs>
          <path d="M50 20 L60 40 L80 45 L65 60 L70 80 L50 70 L30 80 L35 60 L20 45 L40 40 Z" fill="url(#starGrad)"/>
          <circle cx="50" cy="50" r="5" fill="#fff"/>
        </svg>
      </div>
    </div>
  </div>
  <div class="popup" id="verifyPopup">
    <span class="close-btn" onclick="togglePopup()">√ó</span>
    <div class="input-group">
      <label for="aadharNumber">Enter Aadhar Number</label>
      <div class="input-container">
        <span id="aadharDisplay">XXXX-XXXX-XXXX</span>
        <span class="edit-icon" onclick="editAadhar()">‚úé</span>
        <input type="text" id="aadharInput" class="edit-aadhar-input" placeholder="XXXX-XXXX-XXXX " maxlength="14" style="display: none;" oninput="formatAadhar(this)" onkeyup="checkAadhar()">
      </div>
      <div class="otp-field" id="aadharOtp">
        <input type="text" id="aadharOtpInput" placeholder="Enter OTP" maxlength="6">
      </div>
      <button class="save-name-btn" onclick="saveAadhar()" style="display: none;">Save</button>
    </div>
    <div class="input-group">
      <label for="panNumber">Enter PAN Number</label>
      <div class="input-container">
        <span id="panDisplay">ABCDE1234F</span>
        <span class="edit-icon" onclick="editPan()">‚úé</span>
        <input type="text" id="panInput" class="edit-pan-input" placeholder="ABCDE1234F" maxlength="10" style="display: none;" oninput="formatPan(this)" onkeyup="checkPan()">
      </div>
      <div class="otp-field" id="panOtp">
        <input type="text" id="panOtpInput" placeholder="Enter OTP" maxlength="6">
      </div>
      <button class="save-name-btn" onclick="savePan()" style="display: none;">Save</button>
    </div>
    <div class="input-group">
      <label for="accountNumber">Enter Account Number</label>
      <div class="input-container">
        <span id="accountDisplay">XXXXXXXXXXXXXXX</span>
        <span class="edit-icon" onclick="editAccount()">‚úé</span>
        <input type="text" id="accountInput" class="edit-account-input" placeholder="XXXXXXXXXXXXXXX" maxlength="18" style="display: none;" oninput="formatAccount(this)" onkeyup="checkAccount()">
      </div>
      <div class="otp-field" id="accountOtp">
        <input type="text" id="accountOtpInput" placeholder="Enter OTP" maxlength="6">
      </div>
      <button class="save-name-btn" onclick="saveAccount()" style="display: none;">Save</button>
    </div>
  </div>
  <div class="add-money-options" id="addMoneyOptions">
    <span class="close-btn" onclick="toggleAddMoneyOptions()">√ó</span>
    <h3>Choose Payment Method</h3>
    <div class="card-option">
      <input type="text" id="upiIdInput" placeholder="Enter UPI ID (e.g., user@bank)" onkeypress="if(event.key === 'Enter') submitUPI()">
      <input type="button" value="Pay with UPI" onclick="submitUPI()">
    </div>
    <button onclick="redirectToApp('googlepay')">Pay with Google Pay</button>
    <button onclick="redirectToApp('phonepe')">Pay with PhonePe</button>
    <button onclick="redirectToApp('paytm')">Pay with Paytm</button>
    <div class="card-option">
      <input type="text" id="cardNumberInput" placeholder="Enter Card Number (16 digits)" maxlength="16" onkeypress="if(event.key === 'Enter') submitCard()">
      <input type="button" value="Pay with Card" onclick="submitCard()">
    </div>
    <button onclick="redirectToApp('netbanking')">Pay with Net Banking</button>
  </div>
  <div class="video-kyc-popup" id="videoKycPopup">
    <span class="close-btn" onclick="stopVideoKYC()">√ó</span>
    <h3>Video KYC</h3>
    <video id="videoPreview" autoplay muted></video>
    <div class="timer" id="kycTimer">0:00</div>
    <button id="startRecordBtn" onclick="startRecording()">Start Recording</button>
    <button id="stopRecordBtn" onclick="stopRecording()" style="display: none;">Stop Recording</button>
  </div>
  <div class="verified-popup" id="verifiedPopup">
    <span class="close-btn" onclick="closeVerifiedPopup()">√ó</span>
    <h3>Person Verified</h3>
    <div class="tick-animation">
      <svg viewBox="0 0 52 52">
        <circle class="circle" cx="26" cy="26" r="25"/>
        <path class="checkmark" d="M14 27l10 10 14-14"/>
      </svg>
    </div>
    <p>Your identity has been successfully verified!</p>
  </div>

  <script>
    // Load saved name, mobile, email, theme, and profile picture on page load
    document.addEventListener("DOMContentLoaded", function() {
      const savedName = localStorage.getItem("userName");
      if (savedName) {
        document.getElementById("userNameInput").value = savedName;
      }
      const savedMobile = localStorage.getItem("mobileNumber");
      if (savedMobile) {
        document.getElementById("mobileNumberInput").value = savedMobile;
      }
      const savedEmail = localStorage.getItem("emailAddress");
      if (savedEmail) {
        document.getElementById("emailAddressInput").value = savedEmail;
      }
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") {
        document.body.classList.add("dark-mode");
      }
      const savedProfile = localStorage.getItem("profilePicture");
      if (savedProfile) {
        updateLogo(savedProfile);
      }
    });

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("active");
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
      const isDarkMode = document.body.classList.contains("dark-mode");
      localStorage.setItem("theme", isDarkMode ? "dark" : "light");
    }

    function toggleProfilePopup() {
      const popup = document.getElementById("profilePopup");
      popup.classList.toggle("active");
    }

    function selectProfile(profile) {
      localStorage.setItem("profilePicture", profile);
      updateLogo(profile);
      toggleProfilePopup();
    }

    function updateLogo(profile) {
      const logo = document.getElementById("logo");
      let svgContent = '';
      switch (profile) {
        case 'cat':
          svgContent = `
            <svg viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="40" fill="#ffcc00"/>
              <circle cx="35" cy="40" r="8" fill="#000"/>
              <circle cx="65" cy="40" r="8" fill="#000"/>
              <path d="M 30 20 L 40 30 L 50 20" fill="none" stroke="#000" stroke-width="4"/>
              <path d="M 50 20 L 60 30 L 70 20" fill="none" stroke="#000" stroke-width="4"/>
              <path d="M 40 60 Q 50 70 60 60" fill="none" stroke="#000" stroke-width="4"/>
            </svg>`;
          break;
        case 'ninja':
          svgContent = `
            <svg viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="40" fill="#333"/>
              <rect x="30" y="30" width="40" height="10" fill="#ff0000"/>
              <circle cx="40" cy="50" r="5" fill="#fff"/>
              <circle cx="60" cy="50" r="5" fill="#fff"/>
              <path d="M 30 70 L 50 90 L 70 70" fill="none" stroke="#fff" stroke-width="4"/>
            </svg>`;
          break;
        case 'robot':
          svgContent = `
            <svg viewBox="0 0 100 100">
              <rect x="30" y="30" width="40" height="40" fill="#4a4a4a" rx="5"/>
              <rect x="45" y="20" width="10" height="10" fill="#4a4a4a"/>
              <circle cx="40" cy="45" r="5" fill="#00ff00"/>
              <circle cx="60" cy="45" r="5" fill="#00ff00"/>
              <path d="M 35 55 Q 50 60 65 55" fill="none" stroke="#00ff00" stroke-width="3"/>
              <rect x="35" y="70" width="30" height="10" fill="#4a4a4a"/>
            </svg>`;
          break;
        case 'star':
          svgContent = `
            <svg viewBox="0 0 100 100">
              <defs>
                <linearGradient id="starGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#ff8c00;stop-opacity:1" />
                </linearGradient>
              </defs>
              <path d="M50 20 L60 40 L80 45 L65 60 L70 80 L50 70 L30 80 L35 60 L20 45 L40 40 Z" fill="url(#starGrad)"/>
              <circle cx="50" cy="50" r="5" fill="#fff"/>
            </svg>`;
          break;
        default:
          svgContent = `
            <svg viewBox="0 0 50 50">
              <circle cx="25" cy="25" r="25" fill="#1e90ff"/>
              <text x="25" y="32" font-size="20" fill="#fff" text-anchor="middle">RB</text>
            </svg>`;
      }
      logo.innerHTML = svgContent + '<span class="edit-icon" onclick="toggleProfilePopup()">‚úé</span>';
    }

    function saveField(input, fieldId) {
      let newValue = input.value.trim();
      if (fieldId === "mobileNumber") {
        if (!(/^\+91-\d{5}-\d{5}$/.test(newValue) || /^\d{10}$/.test(newValue))) {
          alert("Please enter a valid mobile number (e.g., +91-98765-43210 or 9876543210)");
          input.value = localStorage.getItem(fieldId) || "";
          return;
        }
      } else if (fieldId === "emailAddress") {
        if (!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(newValue)) {
          alert("Please enter a valid email address (e.g., example@email.com)");
          input.value = localStorage.getItem(fieldId) || "";
          return;
        }
      } else if (newValue === "") {
        input.value = localStorage.getItem(fieldId) || "";
        return;
      }
      localStorage.setItem(fieldId, newValue);
    }

    document.getElementById("userNameInput").addEventListener("blur", function() {
      saveField(this, "userName");
    });

    document.getElementById("mobileNumberInput").addEventListener("blur", function() {
      saveField(this, "mobileNumber");
    });

    document.getElementById("emailAddressInput").addEventListener("blur", function() {
      saveField(this, "emailAddress");
    });

    document.getElementById("userNameInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        saveField(this, "userName");
      }
    });

    document.getElementById("mobileNumberInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        saveField(this, "mobileNumber");
      }
    });

    document.getElementById("emailAddressInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        saveField(this, "emailAddress");
      }
    });

    function togglePopup() {
      const popup = document.getElementById("verifyPopup");
      popup.classList.toggle("active");
    }

    function formatAadhar(input) {
      let value = input.value.replace(/[^0-9]/g, '');
      if (value.length > 12) value = value.slice(0, 12);
      if (value.length > 4 && value.length <= 8) {
        value = value.slice(0, 4) + '-' + value.slice(4);
      } else if (value.length > 8) {
        value = value.slice(0, 4) + '-' + value.slice(4, 8) + '-' + value.slice(8);
      }
      input.value = value;
    }

    function formatPan(input) {
      let value = input.value.replace(/[^A-Za-z0-9]/g, '').toUpperCase();
      if (value.length > 10) value = value.slice(0, 10);
      input.value = value;
    }

    function formatAccount(input) {
      let value = input.value.replace(/[^0-9]/g, '');
      if (value.length > 18) value = value.slice(0, 18);
      input.value = value;
    }

    function editAadhar() {
      const display = document.getElementById("aadharDisplay");
      const input = document.getElementById("aadharInput");
      const saveBtn = document.querySelector(".input-group:first-child .save-name-btn");
      const currentValue = display.textContent;
      input.value = currentValue.replace(/-/g, '');
      display.style.display = "none";
      input.style.display = "inline-block";
      saveBtn.style.display = "inline-block";
      input.focus();
    }

    function saveAadhar() {
      const input = document.getElementById("aadharInput");
      const display = document.getElementById("aadharDisplay");
      const saveBtn = document.querySelector(".input-group:first-child .save-name-btn");
      const newValue = input.value.trim();
      if (/^\d{12}$/.test(newValue)) {
        display.textContent = newValue.slice(0, 4) + '-' + newValue.slice(4, 8) + '-' + newValue.slice(8);
        display.style.display = "inline";
        input.style.display = "none";
        saveBtn.style.display = "none";
        checkAadhar();
      } else {
        alert("Please enter a valid 12-digit Aadhar number");
      }
    }

    function editPan() {
      const display = document.getElementById("panDisplay");
      const input = document.getElementById("panInput");
      const saveBtn = document.querySelector(".input-group:nth-child(2) .save-name-btn");
      const currentValue = display.textContent;
      input.value = currentValue;
      display.style.display = "none";
      input.style.display = "inline-block";
      saveBtn.style.display = "inline-block";
      input.focus();
    }

    function savePan() {
      const input = document.getElementById("panInput");
      const display = document.getElementById("panDisplay");
      const saveBtn = document.querySelector(".input-group:nth-child(2) .save-name-btn");
      const newValue = input.value.trim();
      if (/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(newValue)) {
        display.textContent = newValue;
        display.style.display = "inline";
        input.style.display = "none";
        saveBtn.style.display = "none";
        checkPan();
      } else {
        alert("Please enter a valid PAN number (e.g., ABCDE1234F)");
      }
    }

    function editAccount() {
      const display = document.getElementById("accountDisplay");
      const input = document.getElementById("accountInput");
      const saveBtn = document.querySelector(".input-group:nth-child(3) .save-name-btn");
      const currentValue = display.textContent;
      input.value = currentValue;
      display.style.display = "none";
      input.style.display = "inline-block";
      saveBtn.style.display = "inline-block";
      input.focus();
    }

    function saveAccount() {
      const input = document.getElementById("accountInput");
      const display = document.getElementById("accountDisplay");
      const saveBtn = document.querySelector(".input-group:nth-child(3) .save-name-btn");
      const newValue = input.value.trim();
      if (/^\d{9,18}$/.test(newValue)) {
        display.textContent = newValue;
        display.style.display = "inline-block";
        input.style.display = "none";
        saveBtn.style.display = "none";
        checkAccount();
      } else {
        alert("Please enter a valid account number (9-18 digits)");
      }
    }

    function checkAadhar() {
      const aadharInput = document.getElementById("aadharInput");
      const otpField = document.getElementById("aadharOtp");
      if (aadharInput.value.replace(/-/g, '').length === 12) {
        otpField.style.display = "block";
        aadharInput.disabled = true;
      }
    }

    function checkPan() {
      const panInput = document.getElementById("panInput");
      const otpField = document.getElementById("panOtp");
      if (panInput.value.length === 10 && /^[A-Z]{5}[0-9]{4}[A-Z]$/.test(panInput.value)) {
        otpField.style.display = "block";
        panInput.disabled = true;
      }
    }

    function checkAccount() {
      const accountInput = document.getElementById("accountInput");
      const otpField = document.getElementById("accountOtp");
      if (accountInput.value.length >= 9 && accountInput.value.length <= 18) {
        otpField.style.display = "block";
        accountInput.disabled = true;
      }
    }

    function toggleAddMoneyOptions() {
      const options = document.getElementById("addMoneyOptions");
      options.classList.toggle("active");
      if (options.classList.contains("active")) {
        document.getElementById("upiIdInput").value = "";
        document.getElementById("cardNumberInput").value = "";
      }
    }

    function submitUPI() {
      const upiId = document.getElementById("upiIdInput").value.trim();
      if (upiId && /^[\w.-]+@[\w.-]+$/.test(upiId)) {
        alert(`Processing payment with UPI ID: ${upiId}`);
        toggleAddMoneyOptions();
      } else {
        alert("Please enter a valid UPI ID (e.g., user@bank)");
      }
    }

    function submitCard() {
      const cardNumber = document.getElementById("cardNumberInput").value.trim();
      if (cardNumber && /^\d{16}$/.test(cardNumber)) {
        alert(`Processing payment with Card Number: ${cardNumber}`);
        toggleAddMoneyOptions();
      } else {
        alert("Please enter a valid 16-digit card number");
      }
    }

    function redirectToApp(app) {
      let url;
      switch (app) {
        case 'googlepay':
          url = "https://pay.google.com";
          break;
        case 'phonepe':
          url = "https://www.phonepe.com";
          break;
        case 'paytm':
          url = "https://www.paytm.com";
          break;
        case 'netbanking':
          url = "https://www.examplebank.com/netbanking";
          break;
        default:
          url = "";
      }
      if (url) {
        window.open(url, '_blank');
        toggleAddMoneyOptions();
      }
    }

    // Video KYC Functionality
    let stream = null;
    let mediaRecorder = null;
    let recordedBlobs = [];
    let timerInterval = null;

    async function startVideoKYC() {
      const videoKycPopup = document.getElementById("videoKycPopup");
      videoKycPopup.classList.add("active");
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        const video = document.getElementById("videoPreview");
        video.srcObject = stream;
        recordedBlobs = [];
        document.getElementById("startRecordBtn").style.display = "inline-block";
        document.getElementById("stopRecordBtn").style.display = "none";
        document.getElementById("kycTimer").textContent = "0:00";
      } catch (error) {
        alert("Error accessing camera or microphone: " + error.message);
        stopVideoKYC();
      }
    }

    function startRecording() {
      if (!stream) return;
      recordedBlobs = [];
      mediaRecorder = new MediaRecorder(stream, { mimeType: 'video/webm; codecs=vp9,opus' });
      mediaRecorder.ondataavailable = event => {
        if (event.data && event.data.size > 0) {
          recordedBlobs.push(event.data);
        }
      };
      mediaRecorder.onstop = () => {
        clearInterval(timerInterval);
        stopVideoKYC();
        showVerifiedPopup();
      };
      mediaRecorder.start();
      document.getElementById("startRecordBtn").style.display = "none";
      document.getElementById("stopRecordBtn").style.display = "inline-block";

      // Timer for 4 seconds
      let seconds = 0;
      timerInterval = setInterval(() => {
        seconds++;
        const displaySeconds = seconds % 60;
        const displayMinutes = Math.floor(seconds / 60);
        document.getElementById("kycTimer").textContent = `${displayMinutes}:${displaySeconds < 10 ? '0' : ''}${displaySeconds}`;
        if (seconds >= 4) {
          stopRecording();
        }
      }, 1000);
    }

    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state !== "inactive") {
        mediaRecorder.stop();
      }
    }

    function stopVideoKYC() {
      const videoKycPopup = document.getElementById("videoKycPopup");
      videoKycPopup.classList.remove("active");
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
      }
      if (mediaRecorder) {
        mediaRecorder = null;
      }
      clearInterval(timerInterval);
      timerInterval = null;
      const video = document.getElementById("videoPreview");
      video.srcObject = null;
    }

    function showVerifiedPopup() {
      const verifiedPopup = document.getElementById("verifiedPopup");
      verifiedPopup.classList.add("active");
      setTimeout(() => {
        verifiedPopup.classList.remove("active");
      }, 3000); // Auto-close after 3 seconds
    }

    function closeVerifiedPopup() {
      const verifiedPopup = document.getElementById("verifiedPopup");
      verifiedPopup.classList.remove("active");
    }

    // Close popup or options if clicked outside
    document.addEventListener("click", function(event) {
      const popup = document.getElementById("verifyPopup");
      const verifyButton = document.querySelector(".verify-button:not(.card:nth-child(5) .verify-button):not(.card:nth-child(6) .verify-button)");
      if (!verifyButton.contains(event.target) && !popup.contains(event.target)) {
        popup.classList.remove("active");
      }
      const addButton = document.querySelector(".card:nth-child(5) .verify-button");
      const addOptions = document.getElementById("addMoneyOptions");
      if (!addButton.contains(event.target) && !addOptions.contains(event.target)) {
        addOptions.classList.remove("active");
      }
      const videoKycButton = document.querySelector(".card:nth-child(6) .verify-button");
      const videoKycPopup = document.getElementById("videoKycPopup");
      const verifiedPopup = document.getElementById("verifiedPopup");
      if (!videoKycButton.contains(event.target) && !videoKycPopup.contains(event.target) && !verifiedPopup.contains(event.target)) {
        stopVideoKYC();
        verifiedPopup.classList.remove("active");
      }
      const profilePopup = document.getElementById("profilePopup");
      const editIcon = document.querySelector(".edit-icon");
      if (!editIcon.contains(event.target) && !profilePopup.contains(event.target)) {
        profilePopup.classList.remove("active");
      }
    });

    // Handle Enter key for popup inputs
    document.getElementById("aadharInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        saveAadhar();
      }
    });
    document.getElementById("panInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        savePan();
      }
    });
    document.getElementById("accountInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        saveAccount();
      }
    });
  </script>
</body>
</html>